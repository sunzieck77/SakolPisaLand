<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PISA ADVENTURE</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="style.css">
</head>
<body class="min-h-screen overflow-hidden">
<!-- Loading Screen -->
<div id="loadingScreen" class="fixed inset-0 z-50 flex flex-col items-center justify-center">
    <div class="text-center">
        <img src="https://i.ibb.co/GQWFvqSq/header-Logo.png" alt="PISA Adventure" class="w-48 md:w-64 mx-auto mb-8">
        <div class="w-80 bg-white rounded-full p-2 border-4 border-green-500">
            <div id="loadingBar" class="loading-bar w-0 rounded-full"></div>
        </div>
        <p id="loadingText" class="text-white text-xl font-bold mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î... 0%</p>
    </div>
</div>

<!-- Tap to Enter Screen -->
<div id="tapToEnterScreen" class="hidden min-h-screen flex flex-col items-center justify-center relative">
    <img src="https://i.ibb.co/GQWFvqSq/header-Logo.png" alt="PISA Adventure" class="w-48 md:w-64 mb-12 slide-up">
    
    <div class="text-center slide-up">
        <div class="text-white text-2xl md:text-3xl font-bold mb-4 animate-pulse" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
            ‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°
        </div>
        <div class="text-white text-lg md:text-xl opacity-80" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
            Tap anywhere to start
        </div>
    </div>
</div>

<!-- Main Menu Screen -->
<div id="mainMenu" class="hidden min-h-screen flex flex-col items-center justify-center relative">
    <img src="https://i.ibb.co/GQWFvqSq/header-Logo.png" alt="PISA Adventure" class="w-48 md:w-64 mb-8 slide-up">
    
    <div class="flex flex-col space-y-6 slide-up">
        <button id="singlePlayerBtn" class="game-button text-white font-bold py-4 px-8 rounded-xl text-xl">
            üéÆ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
        </button>
        <button id="classroomBtn" class="gold-button text-white font-bold py-4 px-8 rounded-xl text-xl">
            üè´ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </button>
        
        <!-- Settings Button -->
        <button id="settingsBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
            ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        </button>
    </div>
</div>

<!-- Classroom Code Input Screen -->
<div id="classroomCodeScreen" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-90 rounded-2xl p-6 sm:p-8 border-4 border-amber-500 shadow-2xl max-w-md w-full mx-4 sm:mx-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-amber-600 text-center mb-6">üè´ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        
        <div class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
            <input id="classroomCode" type="text" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="w-full px-4 py-3 border-2 border-amber-300 rounded-xl focus:border-amber-500 focus:outline-none text-lg text-center">
            <p class="text-sm text-gray-600 mt-2 text-center">‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡πÉ‡∏´‡πâ‡∏°‡∏≤</p>
        </div>
        
        <div class="flex flex-col space-y-4">
            <button id="submitCodeBtn" class="gold-button text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl disabled:opacity-50 disabled:cursor-not-allowed">
                ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™
            </button>
            <button id="backToMainFromCode" class="game-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Map Tour Screen -->
<div id="mapTour" class="hidden min-h-screen relative" style="background-image: url('https://i.ibb.co/DgmGTJKX/mapBg.png'); background-size: cover; background-position: center;">
    <div class="absolute inset-0 bg-black bg-opacity-20"></div>
    
    <div class="relative z-10 flex flex-col items-center justify-center min-h-screen p-4">
        <img src="https://i.ibb.co/q32sqbxy/MapTItle.png" alt="Map Title" class="w-48 md:w-64 mb-8">
        
        <div class="flex flex-row items-start justify-center space-x-3 sm:space-x-6 md:space-x-8 mb-8 px-4">
            <!-- Map 1: ThaiFruitMerge -->
            <div class="text-center w-24 sm:w-24 md:w-36 flex flex-col">
                <img id="map1" src="https://i.ibb.co/xwWjWn5/ThaiMap.png" alt="Thai Fruit Merge" class="w-20 h-20 sm:w-20 sm:h-20 md:w-32 md:h-32 map-icon unlocked cursor-pointer rounded-xl mx-auto mb-2">
                <div class="h-12 flex items-center justify-center">
                    <p class="text-white font-bold text-xs sm:text-sm md:text-base text-center leading-tight">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</p>
                </div>
            </div>
            
            <!-- Map 2: Math Runner -->
            <div class="text-center w-24 sm:w-24 md:w-36 flex flex-col">
                <img id="map2" src="https://i.ibb.co/HDtmKyCz/MathMap.png" alt="Math Runner" class="w-20 h-20 sm:w-20 sm:h-20 md:w-32 md:h-32 map-icon cursor-pointer rounded-xl mx-auto mb-2">
                <div class="h-12 flex items-center justify-center">
                    <p class="text-white font-bold text-xs sm:text-sm md:text-base text-center leading-tight">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</p>
                </div>
            </div>
            
            <!-- Map 3: Science Fight -->
            <div class="text-center w-24 sm:w-24 md:w-36 flex flex-col">
                <img id="map3" src="https://i.ibb.co/DHvqWQzP/Science-Map.png" alt="Science Fight" class="w-20 h-20 sm:w-20 sm:h-20 md:w-32 md:h-32 map-icon cursor-pointer rounded-xl mx-auto mb-2">
                <div class="h-12 flex items-center justify-center">
                    <p class="text-white font-bold text-xs sm:text-sm md:text-base text-center leading-tight">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</p>
                </div>
            </div>
        </div>
        
        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4 px-4">
            <button id="nextMapBtn" class="game-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è
            </button>
            <button id="homeBtn" class="gold-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Settings Screen -->
<div id="settingsScreen" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-95 rounded-2xl p-6 sm:p-8 border-4 border-gray-400 shadow-2xl max-w-lg w-full mx-4 sm:mx-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-700 text-center mb-8">‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h2>
        
        <!-- Audio Settings Section -->
        <div class="bg-gray-50 rounded-xl p-5 mb-6 border-2 border-gray-200">
            <h3 class="text-lg font-bold text-gray-700 mb-4 flex items-center">
                üéµ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á
            </h3>
            
            <!-- Background Music Volume -->
            <div class="mb-5">
                <label class="block text-gray-700 font-semibold mb-3">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á</label>
                <div class="flex items-center space-x-4">
                    <span class="text-lg">üîá</span>
                    <div class="flex-1 relative">
                        <input type="range" id="bgMusicVolume" min="0" max="100" value="30" 
                                class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <span class="text-lg">üîä</span>
                </div>
                <div class="text-center mt-2">
                    <span id="bgVolumeValue" class="text-sm font-medium text-blue-600 bg-blue-100 px-2 py-1 rounded-full">30%</span>
                </div>
            </div>
            
            <!-- Sound Effects Volume -->
            <div class="mb-5">
                <label class="block text-gray-700 font-semibold mb-3">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Ñ</label>
                <div class="flex items-center space-x-4">
                    <span class="text-lg">üîá</span>
                    <div class="flex-1 relative">
                        <input type="range" id="sfxVolume" min="0" max="100" value="70" 
                                class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"
                                style="background: linear-gradient(to right, #10B981 0%, #10B981 70%, #E5E7EB 70%, #E5E7EB 100%);">
                    </div>
                    <span class="text-lg">üîä</span>
                </div>
                <div class="text-center mt-2">
                    <span id="sfxVolumeValue" class="text-sm font-medium text-green-600 bg-green-100 px-2 py-1 rounded-full">70%</span>
                </div>
            </div>
            
            <!-- Test Sound Button -->
            <div class="text-center">
                <button id="testSoundBtn" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2.5 px-6 rounded-xl text-sm transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üéµ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á
                </button>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="flex flex-col space-y-3">
            <button id="saveSettingsBtn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl transition-all duration-200 transform hover:scale-105 shadow-lg">
                ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            </button>
            <button id="backToMainFromSettings" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-6 rounded-xl text-base transition-all duration-200 transform hover:scale-105 shadow-lg">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- ThaiFruitMerge Game Screen -->
<div id="thaiFruitGame" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-90 rounded-2xl p-6 sm:p-8 border-4 border-green-500 shadow-2xl max-w-md w-full mx-4 sm:mx-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-green-600 text-center mb-6">ü•≠ ThaiFruitMerge</h2>
        
        <div id="playerNameSection" class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <input id="playerName" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" class="w-full px-4 py-3 border-2 border-green-300 rounded-xl focus:border-green-500 focus:outline-none text-lg">
        </div>
        
        <div id="studentNameDisplay" class="mb-6 hidden">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <div class="w-full px-4 py-3 border-2 border-green-300 rounded-xl bg-gray-50 text-lg font-medium text-green-700">
                <span id="displayStudentName"></span>
            </div>
        </div>
        
        <div class="flex flex-col space-y-4">
            <button id="startGameBtn" class="game-button text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl disabled:opacity-50 disabled:cursor-not-allowed">
                üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
            </button>
            <button id="backToMainBtn" class="gold-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Math Runner Game Screen -->
<div id="mathRunnerGame" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <!-- Black overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-50 z-0"></div>
    <div class="bg-white bg-opacity-90 rounded-2xl p-6 sm:p-8 border-4 border-blue-500 shadow-2xl max-w-md w-full mx-4 sm:mx-8 relative z-10">
        <h2 class="text-2xl sm:text-3xl font-bold text-blue-600 text-center mb-6">üßÆ Math Runner</h2>
        
        <div id="mathPlayerNameSection" class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <input id="mathPlayerName" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" class="w-full px-4 py-3 border-2 border-blue-300 rounded-xl focus:border-blue-500 focus:outline-none text-lg">
        </div>
        
        <div id="mathStudentNameDisplay" class="mb-6 hidden">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <div class="w-full px-4 py-3 border-2 border-blue-300 rounded-xl bg-gray-50 text-lg font-medium text-blue-700">
                <span id="displayMathStudentName"></span>
            </div>
        </div>
        
        <div class="flex flex-col space-y-4">
            <button id="startMathGameBtn" class="game-button text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl disabled:opacity-50 disabled:cursor-not-allowed">
                üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
            </button>
            <button id="backToMainFromMath" class="gold-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Science Fight Game Screen -->
<div id="scienceFightGame" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <!-- Black overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-50 z-0"></div>
    <div class="bg-white bg-opacity-90 rounded-2xl p-6 sm:p-8 border-4 border-purple-500 shadow-2xl max-w-md w-full mx-4 sm:mx-8 relative z-10">
        <h2 class="text-2xl sm:text-3xl font-bold text-purple-600 text-center mb-6">üî¨ Science Fight</h2>
        
        <div id="sciencePlayerNameSection" class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <input id="sciencePlayerName" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" class="w-full px-4 py-3 border-2 border-purple-300 rounded-xl focus:border-purple-500 focus:outline-none text-lg">
        </div>
        
        <div id="scienceStudentNameDisplay" class="mb-6 hidden">
            <label class="block text-gray-700 font-bold mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</label>
            <div class="w-full px-4 py-3 border-2 border-purple-300 rounded-xl bg-gray-50 text-lg font-medium text-purple-700">
                <span id="displayScienceStudentName"></span>
            </div>
        </div>
        
        <div class="flex flex-col space-y-4">
            <button id="startScienceGameBtn" class="game-button text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl disabled:opacity-50 disabled:cursor-not-allowed">
                üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
            </button>
            <button id="backToMainFromScience" class="gold-button text-white font-bold py-3 px-6 rounded-xl text-sm sm:text-base">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Science Fight Level Loading Screen -->
<div id="scienceLevelLoading" class="hidden min-h-screen flex flex-col items-center justify-center relative" style="background-image: url('https://i.ibb.co/qG84fGv/load-Level.png'); background-size: cover; background-position: center;">
    <div class="absolute inset-0 bg-black bg-opacity-30"></div>
    
    <div class="relative z-10 text-center">
        <div class="text-4xl sm:text-5xl font-bold text-white mb-8" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Level <span id="loadingLevelNumber">2</span>
        </div>
        
        <div class="w-80 bg-white rounded-full p-2 border-4 border-purple-500 mb-4">
            <div id="levelLoadingBar" class="bg-gradient-to-r from-purple-500 to-purple-700 h-6 rounded-full transition-all duration-300" style="width: 0%;"></div>
        </div>
        
        <p class="text-white text-xl font-bold" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°...</p>
    </div>
</div>

<!-- Teacher Dashboard Screen -->
<div id="teacherDashboard" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-95 rounded-2xl p-6 sm:p-8 border-4 border-blue-500 shadow-2xl max-w-4xl w-full mx-4 sm:mx-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-blue-600 text-center mb-6">üë®‚Äçüè´ ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        
        <!-- Classroom Code Display -->
        <div class="bg-blue-50 rounded-xl p-4 mb-6 border-2 border-blue-200">
            <div class="text-center">
                <h3 class="text-lg font-bold text-blue-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div class="text-3xl font-mono font-bold text-blue-800 bg-white px-4 py-2 rounded-lg border-2 border-blue-300 inline-block">
                    <span id="displayClassroomCode">------</span>
                </div>
                <p class="text-sm text-blue-600 mt-2">‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
            </div>
        </div>
        
        <!-- Student Count -->
        <div class="bg-green-50 rounded-xl p-4 mb-6 border-2 border-green-200">
            <div class="text-center">
                <h3 class="text-lg font-bold text-green-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div class="text-2xl font-bold text-green-800">
                    <span id="studentCount">0</span> / 40 ‡∏Ñ‡∏ô
                </div>
            </div>
        </div>
        
        <!-- Student List -->
        <div class="bg-gray-50 rounded-xl p-4 mb-6 border-2 border-gray-200 max-h-64 overflow-y-auto">
            <h3 class="text-lg font-bold text-gray-700 mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
            <div id="studentList" class="space-y-2">
                <p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
            </div>
        </div>
        
        <!-- Control Buttons -->
        <div class="flex flex-col space-y-4">
            <button id="startTestBtn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl transition-all duration-200 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100" disabled>
                üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏ó‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            </button>
            <button id="viewScoreboardBtn" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                üìä ‡∏î‡∏π Scoreboard
            </button>
            <button id="endTestBtn" class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg hidden">
                üîö ‡∏à‡∏ö‡∏ö‡∏ó‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            </button>
            <button id="backToMainFromTeacher" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-6 rounded-xl text-base transition-all duration-200 transform hover:scale-105 shadow-lg">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Student Selection Screen -->
<div id="studentSelectionScreen" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-95 rounded-2xl p-6 sm:p-8 border-4 border-green-500 shadow-2xl max-w-md w-full mx-4 sm:mx-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-green-600 text-center mb-6">üë®‚Äçüéì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        
        <!-- Class Selection -->
        <div class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
            <select id="classSelect" class="w-full px-4 py-3 border-2 border-green-300 rounded-xl focus:border-green-500 focus:outline-none text-lg">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                <option value="‡∏°.3/1">‡∏°.3/1</option>
                <option value="‡∏°.3/2">‡∏°.3/2</option>
            </select>
        </div>
        
        <!-- Student Selection -->
        <div class="mb-6">
            <label class="block text-gray-700 font-bold mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</label>
            <select id="studentSelect" class="w-full px-4 py-3 border-2 border-green-300 rounded-xl focus:border-green-500 focus:outline-none text-lg" disabled>
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô --</option>
            </select>
        </div>
        
        <!-- Status Display -->
        <div id="studentStatus" class="mb-6 p-4 rounded-xl border-2 hidden">
            <div class="text-center">
                <div class="text-lg font-bold mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</div>
                <div id="statusText" class="text-base"></div>
            </div>
        </div>
        
        <div class="flex flex-col space-y-4">
            <button id="joinClassroomBtn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-lg sm:text-xl transition-all duration-200 transform hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100" disabled>
                ‚è≥ ‡∏£‡∏≠‡∏Ñ‡∏£‡∏π‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏ó‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            </button>
            <button id="backToMainFromStudent" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-6 rounded-xl text-base transition-all duration-200 transform hover:scale-105 shadow-lg">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            </button>
        </div>
    </div>
</div>

<!-- Scoreboard Screen -->
<div id="scoreboardScreen" class="hidden min-h-screen flex flex-col items-center justify-center relative px-4 sm:px-0">
    <div class="bg-white bg-opacity-95 rounded-2xl p-6 sm:p-8 border-4 border-purple-500 shadow-2xl max-w-6xl w-full mx-4 sm:mx-8 max-h-[90vh] overflow-y-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-purple-600 text-center mb-6">üèÜ Scoreboard</h2>
        
        <!-- Map Filter Buttons -->
        <div class="flex flex-wrap justify-center gap-2 mb-6">
            <button class="scoreboard-filter-btn active bg-gradient-to-r from-purple-500 to-purple-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all duration-200" data-map="overall">
                üèÜ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
            <button class="scoreboard-filter-btn bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all duration-200" data-map="thaiFruit">
                ü•≠ ThaiFruitMerge
            </button>
            <button class="scoreboard-filter-btn bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all duration-200" data-map="mathRunner">
                üßÆ Math Runner
            </button>
            <button class="scoreboard-filter-btn bg-gradient-to-r from-red-500 to-red-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all duration-200" data-map="scienceFight">
                üî¨ Science Fight
            </button>
        </div>
        
        <!-- Scoreboard Table -->
        <div class="bg-gray-50 rounded-xl p-4 border-2 border-gray-200">
            <div id="scoreboardContent">
                <!-- Scoreboard content will be populated here -->
            </div>
        </div>
        
        <div class="flex justify-center mt-6">
            <button id="backFromScoreboard" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-6 rounded-xl text-base transition-all duration-200 transform hover:scale-105 shadow-lg">
                üîô ‡∏Å‡∏•‡∏±‡∏ö
            </button>
        </div>
    </div>
</div>

<!-- Science Fight Actual Game -->
<div id="scienceFightActualGame" class="hidden min-h-screen relative overflow-hidden">
    <!-- Top UI Bar - Level, Hearts, Diamonds -->
    <div class="absolute top-4 left-4 right-4 z-20 flex justify-between items-start">
        <div class="flex space-x-2 sm:space-x-3">
            <div class="text-white font-bold text-sm sm:text-lg bg-black bg-opacity-50 px-2 sm:px-3 py-1 sm:py-2 rounded" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
                Level: <span id="scienceLevel">1</span>
            </div>
            <div class="text-white font-bold text-sm sm:text-lg bg-red-600 bg-opacity-80 px-2 sm:px-3 py-1 sm:py-2 rounded flex items-center" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                ‚ù§Ô∏è <span id="scienceHearts">3</span>
            </div>
            <div class="text-white font-bold text-sm sm:text-lg bg-purple-600 bg-opacity-80 px-2 sm:px-3 py-1 sm:py-2 rounded flex items-center" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                üíé <span id="scienceDiamonds">0</span>
            </div>
        </div>
        
        <div class="flex space-x-2">
            <button id="scienceHamburgerBtn" class="bg-black bg-opacity-60 text-white p-2 sm:p-3.5 rounded-xl hover:bg-opacity-80 transition-all duration-200 transform hover:scale-110 shadow-lg">
                <div class="w-4 h-4 sm:w-6 sm:h-6 flex flex-col justify-center space-y-0.5 sm:space-y-1">
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                </div>
            </button>
        </div>
    </div>
    
    <!-- Question Display - Center Top Zone -->
    <div class="absolute top-20 sm:top-24 left-1/2 transform -translate-x-1/2 z-20 w-full max-w-4xl px-4">
        <div class="bg-white rounded-xl p-3 sm:p-4 shadow-2xl border-2 border-blue-200 mx-auto">
            <p class="text-sm sm:text-base font-medium text-blue-800 leading-tight sm:leading-relaxed text-center">
                <span class="font-bold text-blue-900">‡πÇ‡∏à‡∏ó‡∏¢‡πå:</span> <span id="scienceQuestionText"></span>
            </p>
        </div>
    </div>
    
    <!-- Answer Option Boxes - Below question in center -->
    <div class="absolute top-60 left-1/2 transform -translate-x-1/2 z-20 w-full px-4">
        <div class="grid grid-cols-2 gap-3 sm:gap-4 max-w-40 sm:max-w-64 mx-auto">
            <!-- Option A -->
            <div id="scienceOptionA" class="bg-gradient-to-br from-blue-400 to-blue-600 hover:from-blue-500 hover:to-blue-700 text-white font-bold rounded-lg shadow-lg cursor-pointer transition-all duration-200 transform hover:scale-105 w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center">
                <span class="text-lg sm:text-xl">‡∏Å.</span>
            </div>
            
            <!-- Option B -->
            <div id="scienceOptionB" class="bg-gradient-to-br from-green-400 to-green-600 hover:from-green-500 hover:to-green-700 text-white font-bold rounded-lg shadow-lg cursor-pointer transition-all duration-200 transform hover:scale-105 w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center">
                <span class="text-lg sm:text-xl">‡∏Ç.</span>
            </div>
            
            <!-- Option C -->
            <div id="scienceOptionC" class="bg-gradient-to-br from-orange-400 to-orange-600 hover:from-orange-500 hover:to-orange-700 text-white font-bold rounded-lg shadow-lg cursor-pointer transition-all duration-200 transform hover:scale-105 w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center">
                <span class="text-lg sm:text-xl">‡∏Ñ.</span>
            </div>
            
            <!-- Option D -->
            <div id="scienceOptionD" class="bg-gradient-to-br from-red-400 to-red-600 hover:from-red-500 hover:to-red-700 text-white font-bold rounded-lg shadow-lg cursor-pointer transition-all duration-200 transform hover:scale-105 w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center">
                <span class="text-lg sm:text-xl">‡∏á.</span>
            </div>
        </div>
    </div>
    
    <!-- Article Button (Level 4 & 5) -->
    <div id="scienceArticleBtn" class="hidden absolute top-4 right-4 z-20">
        <button class="bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-bold py-2 sm:py-3 px-4 sm:px-6 rounded-lg sm:rounded-xl text-sm sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
            üìñ ‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°
        </button>
    </div>
    
    <!-- Article Modal -->
    <div id="scienceArticleModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-amber-50 to-orange-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-4xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-amber-200 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-amber-700">üìñ ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</h2>
                <button id="scienceCloseArticleBtn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                    ‚úï
                </button>
            </div>
            
            <div class="bg-white rounded-xl p-6 shadow-lg border border-amber-200">
                <h3 id="scienceArticleTitle" class="text-xl font-bold text-gray-800 mb-4"></h3>
                <div id="scienceArticleContent" class="text-gray-700 leading-relaxed whitespace-pre-line"></div>
            </div>
        </div>
    </div>

    <!-- Option Detail Modal -->
    <div id="scienceOptionModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-purple-50 to-indigo-100 rounded-2xl p-6 sm:p-8 max-w-md w-full mx-4 shadow-2xl border-2 border-purple-200">
            <div class="text-center mb-6">
                <div id="scienceOptionLetter" class="bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-full px-4 py-2 inline-block shadow-md text-xl font-bold mb-4">
                    ‡∏Å.
                </div>
                <div class="bg-white rounded-xl p-4 shadow-lg border border-purple-100">
                    <p id="scienceOptionDetail" class="text-base sm:text-lg font-medium text-gray-800 leading-relaxed"></p>
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button id="scienceConfirmAnswer" class="flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    ‡∏ï‡∏Å‡∏•‡∏á
                </button>
                <button id="scienceCancelAnswer" class="flex-1 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
            </div>
        </div>
    </div>
    
    <!-- Player Character -->
    <div id="sciencePlayer" class="absolute bottom-4 left-4 z-15" style="width: 120px; height: 120px;">
        <img src="https://i.ibb.co/1tsZyVD9/player.png" style="width: 100%; height: 100%; object-fit: contain;">
    </div>
    
    <!-- Enemy Character -->
    <div id="scienceEnemy" class="absolute bottom-4 right-4 z-15" style="width: 150px; height: 150px;">
        <img id="scienceEnemyImage" src="https://i.ibb.co/Nny59VZW/boss-Level1.png" style="width: 100%; height: 100%; object-fit: contain;">
        <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold">
            üíé <span id="scienceEnemyDiamondCount">12</span>
        </div>
    </div>
    
    <!-- Science Fight Pause Menu Modal -->
    <div id="sciencePauseMenu" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-purple-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-sm w-full mx-4 shadow-2xl border-2 sm:border-4 border-purple-200">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</h2>
                <button id="scienceResumeBtn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                    ‚ñ∂
                </button>
            </div>
            
            <div class="space-y-4">
                <button id="scienceRestartBtn" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="scienceHomeBtn" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
            </div>
        </div>
    </div>
    
    <!-- Science Fight Summary Modal -->
    <div id="scienceSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-purple-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-2xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-purple-200 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-purple-600 mb-4">üéâ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á</h2>
                <div class="text-xl font-bold text-gray-800 mb-4" id="sciencePlayerSummaryName">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div>
                
                <div class="bg-white rounded-xl p-4 shadow-lg border border-purple-200 mb-4">
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">üíé Diamond ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:</span>
                            <span class="text-purple-600 font-bold text-lg" id="scienceSummaryDiamonds">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">‚úÖ ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å:</span>
                            <span class="text-green-600 font-bold text-lg" id="scienceSummaryCorrect">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">üèÜ Level ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô:</span>
                            <span class="text-blue-600 font-bold text-lg" id="scienceSummaryLevels">1</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col space-y-3">
                <button id="sciencePlayAgainBtn" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="scienceBackToMapBtn" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üó∫Ô∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏°‡∏û
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Math Runner Music -->
<audio id="mathRunnerMusic" loop preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTU5MzZf/Furry%20Friends%20-%20Purple%20Planet%20Music%20%20Cute%20Background%20Music.mp3" type="audio/mpeg">
</audio>

<!-- Math Runner Actual Game -->
<div id="mathRunnerActualGame" class="hidden min-h-screen relative overflow-hidden">
    <!-- Game UI -->
    <div class="absolute top-4 left-4 right-4 z-20 flex justify-between items-start">
        <div class="space-y-2 sm:space-y-3">
            <div class="text-white font-bold text-lg sm:text-2xl bg-black bg-opacity-50 px-3 sm:px-4 py-2 rounded" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
                Score: <span id="mathScore">0</span>
            </div>
            <div class="text-white font-bold text-base sm:text-xl bg-purple-600 bg-opacity-80 px-3 sm:px-4 py-2 rounded flex items-center" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                üíé <span id="mathDiamonds">0</span>
            </div>
            <div class="text-white font-bold text-base sm:text-xl bg-red-600 bg-opacity-80 px-3 sm:px-4 py-2 rounded" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                ‚ö° Speed: <span id="mathSpeed">1.0</span>x
            </div>
            <div class="text-white font-bold text-base sm:text-xl bg-green-600 bg-opacity-80 px-3 sm:px-4 py-2 rounded" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå: <span id="mathQuestions">0</span>/5
            </div>
        </div>
        
        <div class="flex space-x-2">
            <!-- Developer Mode Button (only visible in dev mode) -->
            <button id="mathDevBtn" class="hidden bg-purple-600 bg-opacity-80 text-white p-3 sm:p-3.5 rounded-xl hover:bg-opacity-100 transition-all duration-200 transform hover:scale-110 shadow-lg">
                <div class="w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center">
                    <span class="text-xs sm:text-sm font-bold">DEV</span>
                </div>
            </button>
            
            <button id="mathHamburgerBtn" class="bg-black bg-opacity-60 text-white p-3 sm:p-3.5 rounded-xl hover:bg-opacity-80 transition-all duration-200 transform hover:scale-110 shadow-lg">
                <div class="w-5 h-5 sm:w-6 sm:h-6 flex flex-col justify-center space-y-1 sm:space-y-1">
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                    <div class="w-full h-0.5 bg-white rounded-full"></div>
                </div>
            </button>
        </div>
    </div>
    
    <!-- Operation Sign -->
    <div class="absolute top-20 left-1/2 transform -translate-x-1/2 z-20">
        <div class="bg-white bg-opacity-90 rounded-xl px-6 py-3 border-2 border-gray-300 shadow-lg">
            <div id="currentOperation" class="text-4xl font-bold text-gray-800">?</div>
        </div>
    </div>
    
    <!-- Game Canvas -->
    <canvas id="mathCanvas" class="absolute inset-0 z-10" style="background: transparent;"></canvas>
    
    <!-- Player Character -->
    <div id="mathPlayer" class="absolute z-15" style="bottom: 20px; width: 100px; height: 100px; transition: left 0.3s ease-out;">
        <img id="playerImage" src="https://i.ibb.co/4gp4jLj2/maincharater.png" style="width: 100%; height: 100%; object-fit: contain; transition: transform 0.1s ease-out;">
    </div>
    
    <!-- Math Runner Pause Menu Modal -->
    <div id="mathPauseMenu" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-sm w-full mx-4 shadow-2xl border-2 sm:border-4 border-blue-200">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800">‡πÄ‡∏Å‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</h2>
                <button id="mathResumeBtn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                    ‚ñ∂
                </button>
            </div>
            
            <div class="space-y-4">
                <button id="mathRestartBtn" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="mathHomeBtn" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
            </div>
        </div>
    </div>
    
    <!-- Diamond Effect Container -->
    <div id="mathDiamondEffect" class="hidden fixed inset-0 flex items-center justify-center z-40 pointer-events-none">
        <div id="mathDiamondIcon" class="text-8xl animate-bounce">üíé</div>
    </div>
    
    <!-- Diamond Question Modal -->
    <div id="mathDiamondQuestionModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-yellow-50 to-amber-100 rounded-2xl sm:rounded-3xl p-4 sm:p-8 max-w-2xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-yellow-200 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-4 sm:mb-6">
                <div class="bg-gradient-to-r from-yellow-400 to-amber-500 text-white rounded-full px-3 sm:px-4 py-1 inline-block shadow-md">
                    <span class="text-sm sm:text-lg font-bold">üíé Diamond Question <span id="mathDiamondQuestionNumber">1</span>/5</span>
                </div>
            </div>
            
            <div id="mathDiamondQuestionContent" class="mb-6 sm:mb-8">
                <div class="bg-white rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-lg border border-yellow-100 sm:border-2 mb-4 sm:mb-6">
                    <p id="mathDiamondQuestionText" class="text-base sm:text-xl font-medium text-gray-800 leading-relaxed"></p>
                </div>
                <div id="mathDiamondQuestionOptions" class="space-y-3 sm:space-y-4"></div>
                <div id="mathDiamondTextInput" class="hidden">
                    <input type="number" id="mathDiamondAnswer" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç" class="w-full px-4 py-3 border-2 border-yellow-300 rounded-xl focus:border-yellow-500 focus:outline-none text-lg text-center">
                </div>
            </div>
            
            <div class="flex justify-center">
                <button id="mathSubmitDiamondAnswer" class="bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white font-bold py-3 sm:py-4 px-6 sm:px-8 rounded-xl sm:rounded-2xl text-base sm:text-lg shadow-lg transform transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
                    ‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
                </button>
            </div>
        </div>
    </div>
    
    <!-- Diamond Summary Modal -->
    <div id="mathDiamondSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-yellow-50 to-amber-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-2xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-yellow-200 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-amber-600 mb-4">üéâ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á</h2>
                <div class="text-xl font-bold text-gray-800 mb-4" id="mathPlayerSummaryName">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div>
                
                <div class="bg-white rounded-xl p-4 shadow-lg border border-yellow-200 mb-4">
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">üíé Diamond ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:</span>
                            <span class="text-purple-600 font-bold text-lg" id="mathSummaryDiamonds">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700 font-medium">üìù ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏ñ‡∏π‡∏Å:</span>
                            <span class="text-blue-600 font-bold text-lg"><span id="mathSummaryQuestions">0</span>/5</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col space-y-3">
                <button id="mathNextKingdomBtn" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üè∞ ‡∏≠‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                </button>
                <button id="mathShowSolutions" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üìñ ‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥
                </button>
                <button id="mathCloseDiamondSummary" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üéÆ ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°
                </button>
            </div>
        </div>
    </div>
    
    <!-- Diamond Solutions Modal -->
    <div id="mathDiamondSolutionsModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-yellow-50 to-amber-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-4xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-yellow-200 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-amber-600 mb-4">üìñ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå Diamond</h2>
                <div class="bg-gradient-to-r from-yellow-400 to-amber-500 text-white rounded-full px-4 py-2 inline-block shadow-md">
                    <span class="text-lg font-bold">‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="mathDiamondScore">0</span>/5 ‡∏Ç‡πâ‡∏≠</span>
                </div>
            </div>
            
            <div id="mathDiamondSolutions" class="space-y-6 mb-8">
                <!-- Solutions will be populated here -->
            </div>
            
            <div class="flex justify-center">
                <button id="mathCloseSolutions" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üîô ‡∏Å‡∏•‡∏±‡∏ö
                </button>
            </div>
        </div>
    </div>
    
    <!-- Lane Indicators (for debugging) -->
    <div class="absolute bottom-0 left-0 right-0 h-32 z-5 pointer-events-none hidden" id="laneDebug">
        <div class="h-full flex">
            <div class="flex-1 border-r border-white border-opacity-30"></div>
            <div class="flex-1 border-r border-white border-opacity-30"></div>
            <div class="flex-1 border-r border-white border-opacity-30"></div>
            <div class="flex-1"></div>
        </div>
    </div>
    
    <!-- Math Runner Developer Panel -->
    <div id="mathDevPanel" class="hidden fixed top-4 left-4 z-50 bg-gradient-to-br from-purple-50 to-indigo-100 rounded-2xl p-4 shadow-2xl border-2 border-purple-200 max-w-xs">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-bold text-purple-800">üîß Dev Panel</h2>
            <button id="closeMathDevPanelBtn" class="text-gray-500 hover:text-gray-700 text-xl font-bold w-6 h-6 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                ‚úï
            </button>
        </div>
        
        <div class="space-y-3">
            <!-- Box Spawning -->
            <div class="bg-white rounded-lg p-3 border border-purple-200">
                <h3 class="text-sm font-bold text-purple-700 mb-2">üì¶ Spawn</h3>
                <div class="grid grid-cols-3 gap-1">
                    <button class="math-spawn-btn bg-blue-100 hover:bg-blue-200 p-1 rounded text-xs font-medium transition-all" data-type="number">üî¢</button>
                    <button class="math-spawn-btn bg-red-100 hover:bg-red-200 p-1 rounded text-xs font-medium transition-all" data-type="rainbow">üåà</button>
                    <button class="math-spawn-btn bg-yellow-100 hover:bg-yellow-200 p-1 rounded text-xs font-medium transition-all" data-type="speed">‚ö°</button>
                    <button class="math-spawn-btn bg-green-100 hover:bg-green-200 p-1 rounded text-xs font-medium transition-all" data-type="slowness">üêå</button>
                    <button class="math-spawn-btn bg-orange-100 hover:bg-orange-200 p-1 rounded text-xs font-medium transition-all" data-type="bomb">üí£</button>
                    <button class="math-spawn-btn bg-purple-100 hover:bg-purple-200 p-1 rounded text-xs font-medium transition-all" data-type="diamond">üíé</button>
                </div>
            </div>
            
            <!-- Speed Control -->
            <div class="bg-white rounded-lg p-3 border border-purple-200">
                <h3 class="text-sm font-bold text-purple-700 mb-2">‚ö° Speed</h3>
                <div class="space-y-1">
                    <label class="text-xs text-gray-600">Speed: <span id="mathSpeedValue">1.0</span>x</label>
                    <input type="range" id="mathSpeedSlider" min="0.1" max="10" step="0.1" value="1.0" class="w-full h-2">
                </div>
            </div>
            
            <!-- Operation Lock -->
            <div class="bg-white rounded-lg p-3 border border-purple-200">
                <h3 class="text-sm font-bold text-purple-700 mb-2">üîí Operation Lock</h3>
                <div class="grid grid-cols-2 gap-1 mb-2">
                    <button class="math-op-btn bg-gray-100 hover:bg-gray-200 p-1 rounded text-xs font-medium transition-all" data-op="+">+</button>
                    <button class="math-op-btn bg-gray-100 hover:bg-gray-200 p-1 rounded text-xs font-medium transition-all" data-op="-">-</button>
                    <button class="math-op-btn bg-gray-100 hover:bg-gray-200 p-1 rounded text-xs font-medium transition-all" data-op="√ó">√ó</button>
                    <button class="math-op-btn bg-gray-100 hover:bg-gray-200 p-1 rounded text-xs font-medium transition-all" data-op="√∑">√∑</button>
                </div>
                <button id="mathUnlockOpBtn" class="w-full bg-red-100 hover:bg-red-200 text-red-700 font-bold py-1 px-2 rounded text-xs transition-all">
                    üîì Unlock (Random)
                </button>
            </div>
            
            <!-- Background Control -->
            <div class="bg-white rounded-lg p-3 border border-purple-200">
                <button id="mathRandomBgBtn" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-1 px-2 rounded text-xs transition-all">
                    üé≤ Random BG
                </button>
            </div>
            
            <!-- Exit Dev Mode -->
            <div class="bg-white rounded-lg p-3 border border-purple-200">
                <button id="mathExitDevBtn" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-2 rounded text-xs transition-all">
                    ‚ùå Exit Dev
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ThaiFruitMerge Actual Game -->
<div id="fruitMergeGame" class="hidden min-h-screen relative overflow-hidden">


    <!-- Hamburger Menu Modal -->
    <div id="hamburgerMenu" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-md w-full mx-4 shadow-2xl border-2 sm:border-4 border-blue-200">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800">‡πÄ‡∏°‡∏ô‡∏π</h2>
                <button id="closeMenuBtn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                    ‚úï
                </button>
            </div>
            
            <!-- Volume Controls Section -->
            <div class="bg-white rounded-xl p-4 mb-6 border-2 border-blue-200">
                <h3 class="text-lg font-bold text-gray-700 mb-4 flex items-center">
                    üéµ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á
                </h3>
                
                <!-- Background Music Volume -->
                <div class="mb-4">
                    <label class="block text-gray-700 font-semibold mb-2 text-sm">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á</label>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm">üîá</span>
                        <div class="flex-1 relative">
                            <input type="range" id="gameBgMusicVolume" min="0" max="100" value="30" 
                                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        </div>
                        <span class="text-sm">üîä</span>
                    </div>
                    <div class="text-center mt-1">
                        <span id="gameBgVolumeValue" class="text-xs font-medium text-blue-600 bg-blue-100 px-2 py-1 rounded-full">30%</span>
                    </div>
                </div>
                
                <!-- Sound Effects Volume -->
                <div class="mb-4">
                    <label class="block text-gray-700 font-semibold mb-2 text-sm">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Ñ</label>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm">üîá</span>
                        <div class="flex-1 relative">
                            <input type="range" id="gameSfxVolume" min="0" max="100" value="70" 
                                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"
                                    style="background: linear-gradient(to right, #10B981 0%, #10B981 70%, #E5E7EB 70%, #E5E7EB 100%);">
                        </div>
                        <span class="text-sm">üîä</span>
                    </div>
                    <div class="text-center mt-1">
                        <span id="gameSfxVolumeValue" class="text-xs font-medium text-green-600 bg-green-100 px-2 py-1 rounded-full">70%</span>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <button id="restartFromMenu" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="homeFromMenu" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 sm:py-4 px-6 rounded-xl text-base sm:text-lg transition-all duration-200 transform hover:scale-105 shadow-lg">
                    üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                </button>
            </div>
        </div>
    </div>

    <!-- Game Canvas Container -->
    <div class="absolute inset-0 flex items-center justify-center">
        <div id="gameContainer" class="relative overflow-hidden" style="width: 470px; height: 780px; border-radius: 24px; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
            <!-- Game Container Border - ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô -->
            <div class="absolute inset-0 border-4 border-white border-opacity-60 pointer-events-none z-10" style="border-radius: 20px;"></div>
            
            <!-- Game UI -->
            <div class="absolute top-4 left-4 z-20 space-y-1 sm:space-y-2">
                <div class="text-white font-bold text-sm sm:text-lg bg-black bg-opacity-50 px-2 sm:px-3 py-1 rounded" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
                    ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="gameScore">0</span>
                </div>
                <div class="text-white font-bold text-xs sm:text-sm bg-purple-600 bg-opacity-80 px-2 sm:px-3 py-1 rounded flex items-center" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                    üíé <span id="gameDiamonds">0</span>
                </div>
                <div class="text-white font-bold text-xs sm:text-sm bg-green-600 bg-opacity-80 px-2 sm:px-3 py-1 rounded" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
                    üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå: <span id="questionsCompleted">0</span>/5
                </div>
            </div>
            
            <!-- Hamburger Menu Button - Inside game border -->
            <div class="absolute top-4 right-4 z-20 flex space-x-2">
                <!-- Developer Mode Button (only visible in dev mode) -->
                <button id="devBtn" class="hidden bg-purple-600 bg-opacity-80 text-white p-3 sm:p-3.5 rounded-xl hover:bg-opacity-100 transition-all duration-200 transform hover:scale-110 shadow-lg">
                    <div class="w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center">
                        <span class="text-xs sm:text-sm font-bold">DEV</span>
                    </div>
                </button>
                
                <button id="hamburgerBtn" class="bg-black bg-opacity-60 text-white p-3 sm:p-3.5 rounded-xl hover:bg-opacity-80 transition-all duration-200 transform hover:scale-110 shadow-lg">
                    <div class="w-5 h-5 sm:w-6 sm:h-6 flex flex-col justify-center space-y-1 sm:space-y-1">
                        <div class="w-full h-0.5 bg-white rounded-full"></div>
                        <div class="w-full h-0.5 bg-white rounded-full"></div>
                        <div class="w-full h-0.5 bg-white rounded-full"></div>
                    </div>
                </button>
            </div>
            
            <!-- Next Fruit Preview -->
            <div class="absolute z-20" style="top: 80px; right: 16px;">
                <div class="bg-white bg-opacity-90 rounded-xl text-center shadow-lg border-2 border-white" style="width: 56px; height: 56px; padding: 8px; display: flex; align-items: center; justify-content: center;">
                    <div id="nextFruitPreview" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;"></div>
                </div>
            </div>

            <!-- Fruit Collection Progress - Horizontal Bar -->
            <div class="absolute top-48 sm:top-60 left-1/2 transform -translate-x-1/2 z-10 px-3 sm:px-4 py-1.5 sm:py-2">
                <div id="currentProgress" class="flex items-center space-x-2 sm:space-x-3">
                    <div class="flex items-center space-x-1 sm:space-x-2">
                        <div id="currentFruitIcon" class="w-4 h-4 sm:w-6 sm:h-6"></div>
                        <span class="text-gray-800 text-xs sm:text-sm font-bold" style="text-shadow: 1px 1px 2px rgba(255,255,255,0.8);"><span id="currentCount">0</span>/<span id="currentTarget">200</span></span>
                    </div>
                    <div class="w-24 sm:w-32 bg-gray-300 rounded-full h-1.5 sm:h-2">
                        <div id="progressBar" class="bg-gradient-to-r from-orange-400 to-orange-600 h-1.5 sm:h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Danger Line -->
            <div id="dangerLine" class="absolute left-0 right-0 z-10 h-0.5 sm:h-1 bg-red-500 shadow-lg" style="top: 160px;">
                <div class="absolute inset-0 bg-red-500 animate-pulse shadow-red-500 shadow-lg"></div>
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-red-300 to-transparent animate-ping"></div>
            </div>
            
            <!-- Current Fruit -->
            <div id="currentFruit" class="absolute z-25" style="top: 80px; left: 235px; transform: translateX(-50%);"></div>
            
            <!-- Drop Guide Line -->
            <div id="dropGuideLine" class="absolute w-1 bg-white bg-opacity-80 z-0 hidden shadow-lg" style="box-shadow: 0 0 10px rgba(255,255,255,0.5);"></div>
            
            <!-- Game Background Pattern -->
            <div class="absolute inset-0 z-0" style="background: repeating-linear-gradient(45deg, #fbed82 0px, #fbed82 20px, #fef085 20px, #fef085 40px);"></div>
            
            <!-- Game Canvas -->
            <canvas id="gameCanvas" width="470" height="780" class="absolute inset-0 z-5" style="background: transparent;"></canvas>
            
            <!-- Particles Container -->
            <div id="particlesContainer" class="absolute inset-0 z-30 pointer-events-none"></div>
        </div>
    </div>
    
    <!-- Question Modal -->
    <div id="questionModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-4 sm:p-8 max-w-2xl w-full mx-4 shadow-2xl border-2 sm:border-4 border-blue-200 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-4 sm:mb-6">
                <div class="bg-white rounded-full px-3 sm:px-4 py-1 inline-block shadow-md">
                    <span class="text-sm sm:text-lg font-bold text-blue-600">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="questionNumber">1</span>/5</span>
                </div>
            </div>
            
            <div id="questionContent" class="mb-6 sm:mb-8">
                <div class="bg-white rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-lg border border-blue-100 sm:border-2 mb-4 sm:mb-6">
                    <p id="questionText" class="text-base sm:text-xl font-medium text-gray-800 leading-relaxed"></p>
                </div>
                <div id="questionOptions" class="space-y-3 sm:space-y-4"></div>
            </div>
            
            <div class="flex justify-center">
                <button id="submitAnswer" class="bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 sm:py-4 px-6 sm:px-8 rounded-xl sm:rounded-2xl text-base sm:text-lg shadow-lg transform transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
                    ‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
                </button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center max-w-sm w-full mx-4">
            <h2 class="text-2xl sm:text-3xl font-bold text-red-600 mb-3 sm:mb-4">‡πÄ‡∏Å‡∏°‡∏à‡∏ö!</h2>
            <p class="text-lg sm:text-xl mb-2">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢:</p>
            <p id="finalScore" class="text-3xl sm:text-4xl font-bold text-green-600 mb-2">0</p>
            <p class="text-base sm:text-lg mb-2">üíé Diamond: <span id="finalDiamonds" class="font-bold text-purple-600">0</span></p>
            <p class="text-base sm:text-lg mb-4 sm:mb-6">üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ó‡∏≥: <span id="finalQuestions" class="font-bold text-blue-600">0</span>/5</p>
            <div class="flex flex-col space-y-2 sm:space-y-3">
                <button id="playAgainBtn" class="game-button text-white font-bold py-2.5 sm:py-3 px-5 sm:px-6 rounded-lg sm:rounded-xl text-sm sm:text-base">
                    ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="backToMapBtn" class="gold-button text-white font-bold py-2 sm:py-2 px-5 sm:px-6 rounded-lg sm:rounded-xl text-sm sm:text-base">
                    ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏°‡∏û
                </button>
            </div>
        </div>
    </div>

    <!-- Final Summary Modal -->
    <div id="finalSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center max-w-md w-full mx-4">
            <h2 class="text-2xl sm:text-3xl font-bold text-green-600 mb-3 sm:mb-4">üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</h2>
            <p class="text-lg sm:text-xl mb-3 sm:mb-4"><span id="displayStudentNameMap1">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</span></p>
            
            <div class="bg-gray-100 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6">
                <div class="text-base sm:text-lg mb-2">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</div>
                <div class="space-y-1.5 sm:space-y-2 text-left text-sm sm:text-base">
                    <div class="flex justify-between">
                        <span>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:</span>
                        <span id="summaryScore" class="font-bold text-green-600">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>üíé Diamond:</span>
                        <span id="summaryDiamonds" class="font-bold text-purple-600">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span>üìù ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö:</span>
                        <span id="summaryCorrectAnswers" class="font-bold text-blue-600">5/5</span>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col space-y-2 sm:space-y-3">
                <button id="continuePlayingBtn" class="game-button text-white font-bold py-2.5 sm:py-3 px-5 sm:px-6 rounded-lg sm:rounded-xl text-sm sm:text-base">
                    üó∫Ô∏è ‡πÅ‡∏°‡∏û‡∏ï‡πà‡∏≠‡πÑ‡∏õ
                </button>
                <button id="backToMapFromSummary" class="gold-button text-white font-bold py-2 sm:py-2 px-5 sm:px-6 rounded-lg sm:rounded-xl text-sm sm:text-base">
                    üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏°‡∏û
                </button>
            </div>
        </div>
    </div>

    <!-- Developer Menu Modal -->
    <div id="devMenuModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-purple-50 to-indigo-100 rounded-2xl sm:rounded-3xl p-6 sm:p-8 max-w-md w-full mx-4 shadow-2xl border-2 sm:border-4 border-purple-200">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-purple-800">üîß Developer Menu</h2>
                <button id="closeDevMenuBtn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 transition-all duration-200">
                    ‚úï
                </button>
            </div>
            
            <div class="space-y-4">
                <div class="bg-white rounded-xl p-4 border border-purple-200">
                    <h3 class="text-lg font-bold text-purple-700 mb-3">üçé Fruit Selection</h3>
                    <div class="text-sm text-gray-600 mb-3">Current: <span id="currentDevFruit" class="font-bold text-purple-600">Random</span></div>
                    
                    <div class="grid grid-cols-3 gap-2 mb-3">
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="-1">üé≤ Random</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="0">üçå Banana</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="1">ü•≠ Mango</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="2">üçç Pineapple</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="3">ü•• Coconut</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="4">üçà Melon</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="5">üçâ Watermelon</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="6">ü•≠ Durian</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="7">üèÜ Victory</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="8">üíº FruitWork</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="9">üíé Diamond1</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="10">üíé Diamond2</button>
                        <button class="dev-fruit-btn bg-purple-100 hover:bg-purple-200 p-2 rounded-lg text-xs font-medium transition-all" data-fruit="11">üíé Diamond3</button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-4 border border-purple-200">
                    <h3 class="text-lg font-bold text-purple-700 mb-3">‚ö° Quick Actions</h3>
                    <div class="space-y-2">
                        <button id="devAddScore" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                            +1000 Score
                        </button>
                        <button id="devAddDiamond" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                            +10 Diamonds
                        </button>
                        <button id="devClearFruits" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                            Clear All Fruits
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Background Music -->
<audio id="backgroundMusic" loop preload="auto" autoplay muted style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MDc2MzBf/Morning%20Peppermint.mp3" type="audio/mpeg">
</audio>

<!-- Fruit Game Music -->
<audio id="fruitGameMusic" loop preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTU5MzBf/boba%20date%20%20%20cute%20background%20music%20%28royalty%20free%29.mp3" type="audio/mpeg">
</audio>

<!-- Merge Sound Effects -->
<audio id="mergeSound1" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NDNfNDI3ODc4NThf/pop1.mp3" type="audio/mpeg">
</audio>
<audio id="mergeSound2" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NDNfNDI3ODc4NTlf/pop2.mp3" type="audio/mpeg">
</audio>
<audio id="mergeSound3" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NDNfNDI3ODc4NjBf/pop3.mp3" type="audio/mpeg">
</audio>

<!-- Victory Sound Effect -->
<audio id="victorySound" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYwMDNf/Victory%20Game%20Sound%20Effect.mp3" type="audio/mpeg">
</audio>

<!-- FruitWork Drop Sound -->
<audio id="fruitWorkDropSound" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYzNjdf/sparkle%20fruitwork.mp3" type="audio/mpeg">
</audio>

<!-- Math Runner Diamond Sparkle Sound -->
<audio id="mathDiamondSparkleSound" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYzNjdf/sparkle%20fruitwork.mp3" type="audio/mpeg">
</audio>

<!-- Science Fight Music -->
<audio id="scienceFightMusic" loop preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYzODlf/Clothing%20Shop%20-%20Tomodachi%20Life%20OST.mp3" type="audio/mpeg">
</audio>

<!-- Science Fight Sound Effects -->
<audio id="scienceBossAttackSound" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYzOTNf/boss%20attack.mp3" type="audio/mpeg">
</audio>

<audio id="scienceCorrectSound" preload="auto" style="display: none;">
    <source src="https://od.lk/s/NzFfMjY3MTYzOTRf/correct.mp3" type="audio/mpeg">
</audio>

<script src="game.patched.js"></script>
</body>
</html>
